## 情绪词类型判断实验

 - 实验流程：
 1. 欢迎
 2. 实验指导语
 3. 实验刺激：注视点+情绪词汇
 4. 结束：实验结果+结束语
 
 - JsPsych程序介绍：
1. HTML文件程序介绍：

>     <!DOCTYPE html>
>      <html>
>      <head>
>      <title>My experiment</title>
>      <script src="https://unpkg.com/jspsych@7.3.4"></script>
>      <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@1.1.3"></script>
>      <link href="https://unpkg.com/jspsych@7.3.4/css/jspsych.css" rel="stylesheet" type="text/css" />
>      <script src="实验.js"></script>

这段代码设置了文档类型和基本HTML结构。并且，代码引用了jsPsych库及其插件，用于创建和运行心理学实验，同时也引用jsPsych的CSS样式表，从而确保实验界面美观。最后一段代码是引用自定义的JavaScript文件“实验.js”，其中包含了具体的实验逻辑。

>     <style>
>          body, html {
> 		    display: flex;
> 		    justify-content: center;
> 	        align-items: center;
> 	        background-color: white;
>      	    height: 100%;
>      	    margin: 0;
>      	    }
>          #jspsych-target {
>      	    background-color:white;
>      	    display: flex;
>      	    justify-content: center;
>      	    align-items: center;
>      	    flex-direction: column;
>      	    width: 100%;
>      	    height: 100%;
>      	    }
>          .jspsych-content {
>      	    font-size: 48px;
>      	    text-align: center;
>      	    }
>          .instructions {
>      	    margin-bottom: 0;
>      	    font-size: 30px;
>      	    white-space: nowrap;
>      	    }
>          .stimulus {
>      	    display: flex;
>      	    justify-content: center;
>      	    align-items: center;
>      	    flex-direction: column;
>      	    width: 100%;
>      	    height: 100%;
>      	    margin-bottom: 0;
>      	    font-size: 48px;
>      	    white-space: nowrap;
>      	    }  	
>     </style>  
>     </head>  	
>     <body>
> 	   	 	<div id="jspsych-target"></div>
> 	    		<script></script>  	
> </body> </html>

这段CSS代码的作用是定义实验页面的布局和样式，使得页面内容在垂直和水平方向上居中对齐，并为不同的元素（如instructions和stimulus）设置特定的样式（如字体大小和是否换行）。这些样式保证了实验页面在不同设备上的一致性和美观性。

2. JavaScript文件内容：

>     > const jsPsych = initJsPsych ({
>     	> display_element:
>     	'jspsych-target',
>     	override_safe_mode: true,
>     	on_finish: function() {
>     		jsPsych.data.displayData();
>     		jsPsych.data.get().localSave
>     		('csv','exp_data.csv');
>     	}
>     });
 
初始化 JsPsych：使用  `initJsPsych`  函数来初始化 JsPsych，并将其配置参数传递给它。

display_element：指定 JsPsych 将内容显示在具有 ID 为  `jspsych-target`  的 HTML 元素中。确保在你的 HTML 文件中有一个具有这个 ID 的元素。

override_safe_mode：设置为  `true`，用于覆盖安全模式的设置，这通常用于开发过程中，如果出现问题可以尝试禁用一些默认的安全设置。

on_finish：当实验完成时，会执行  `on_finish`  中指定的函数。

>     document.addEventListener('click', () => {
>        if (jsPsych.audioContext) {
>     		  jsPsych.audioContext.resume();
>     }});

这段代码的作用是确保在用户点击页面时，JsPsych 的音频上下文（AudioContext）恢复，以便能够播放音频。虽然在实验中没有用到音频刺激，但是如果不加入这串代码，网页将会在报错，例如“JsPsych.ts:128 The AudioContext was not allowed to start. It must be resumed (or created) after a user gesture on the page. https://goo.gl/7K7WLu i @ JsPsych.ts:128 e.initJsPsych @ index.ts:26 （匿名） @ 实验.js:1”

在添加这段代码，以及前面的“override_safe_mode:  true”后，程序错误解除

> `var  timeline  = [];`

这行代码定义了一个空数组 `timeline`，用于存储 JsPsych 实验的时间线。时间线是实验中各个步骤（试次）的有序集合。每个步骤可以是一个单独的试次（trial）或一系列试次。

>     var  welcome  = {
>     type:  jsPsychHtmlKeyboardResponse,
>     stimulus:  '<p class="instructions">欢迎您参与我们的实验。请按任意键进入试验阶段。</p>'
>     };
>     timeline.push(welcome);
这段代码创建了一个欢迎试次，并将其添加到实验的时间线中。

>     var  instructions  = {
>     type:  jsPsychHtmlKeyboardResponse,
>     stimulus:  `
>     <p class="instructions">在接下来的实验任务中，你将会看到屏幕上显示不同的<strong>情绪词汇</strong>。</p>
>     <p class="instructions">如积极词汇“开心”、“愉悦”、“激动”；消极词汇“生气”、“悲伤”、“懊悔”。</p>
>     <p class="instructions">您的任务是判断这些词汇的类别（积极/消极），对它们的<strong>类别</strong>进行反应。</p>
>     <p class="instructions"><strong>积极词汇按"f" ，消极词汇按"j" 。</strong></p>
>     <p class="instructions">如清楚上述说明，则请按任意键开始实验。</p>
>     `
>     };
>     timeline.push(instructions);
这段代码创建了一个包含实验说明的试次，并将其添加到时间线中。


>     var  stimulus  = [
>     { word:  '生气', color:  'black', category:  'negative' },
>     { word:  '兴奋', color:  'black', category:  'positive' },
>     { word:  '沮丧', color:  'black', category:  'negative' },
>     { word:  '愤怒', color:  'black', category:  'negative' },
>     { word:  '欣喜', color:  'black', category:  'positive' },
>     { word:  '愉悦', color:  'black', category:  'positive' },
>     { word:  '欢乐', color:  'black', category:  'positive' },
>     { word:  '激动', color:  'black', category:  'positive' },
>     { word:  '懊悔', color:  'black', category:  'negative' },
>     { word:  '不安', color:  'black', category:  'negative' }
>     ];
>     
>     var  fixation  = {
>     type:  jsPsychHtmlKeyboardResponse,
>     stimulus:  '<div style="font-size: 50px; color: red; display: flex;
>     justify-content: center; align-items: center;">+</div>',
>     choices:  "NO_KEYS",
>     trial_duration:  function(){
>     return  jsPsych.randomization.sampleWithoutReplacement([250, 500, 750, 1000, 1250], 1)[0];
>     },
>     data: {
>     task:  'fixation'
>     }
>     };
>     
>     var  trials  = [];
>     for (var  i  =  0; i  <  stimulus.length; i++) {
>     for (var  j  =  0; j  <  20; j++) {
>     trials.push({
>     stimulus:  `<p class="stimulus"
>     style="color:${stimulus[i].color};">${stimulus[i].word}</p>`,
>     data: {
>     word:  stimulus[i].word,
>     color:  stimulus[i].color,
>     category:  stimulus[i].category
>     }
>     });
>     }
>     }
>     
>     trials  =  jsPsych.randomization.shuffle(trials);
>     
>     var  trial  = {
>     type:  jsPsychHtmlKeyboardResponse,
>     stimulus:  jsPsych.timelineVariable('stimulus'),
>     choices: ['f','j'],
>     data:  jsPsych.timelineVariable('data'),
>     on_finish:  function(data){
>     var  correct  =  false;
>     if ((data.category  ===  'positive'  &&  data.response  ===  'f') ||
>     (data.category  ===  'negative'  &&  data.response  ===  'j') ) {
>     correct  =  true;
>     data.correct  =  correct;
>     }
>     };  
>     
>     var  test_procedure  = {
>     timeline: [fixation,trial],
>     timeline_variables:  trials,
>     repetitions:  1,
>     randomize_order:  true
>     };
>     > timeline.push(test_procedure);
这段代码创建了一个包含不同情绪词汇的实验，并将其添加到时间线中。
1. 定义刺激变量 `stimulus`
2. 定义刺激变量 `stimulus`
3. 创建试次 `trials`
4. 随机化试次顺序
5. 定义实验试次 `trial`
6. 创建实验过程 `test_procedure`
7. 将实验过程添加到时间线 `timeline`


>     var  debrief  = { 
>     type:  jsPsychHtmlKeyboardResponse, 
>     stimulus: 
>     function() {
>     var  trials  = jsPsych.data.get().filter({task: 'response'}); 	var  correct_trials  =  trials.filter({correct: 
>     true}); 	var  accuracy  = Math.round(correct_trials.count() / 
>     trials.count()*  100);  	var  rt  =
>     Math.round(correct_trials.select('rt').mean()); 	return`<p>实验结束！感谢参与！</p><p>你的正确率是 ${accuracy}%.</p><p>按任意键结束。</p>`; 	}  	}; 
>     timeline.push(debrief);
>    
>     jsPsych.run(timeline);

这段代码创建了一个实验结束后的反馈试次，并将其添加到时间线中。
